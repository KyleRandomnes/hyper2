---
title: "fisher_information_plackett_luce_three_runners"
output: html_document
date: "2022-08-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem

We consider three runners, $a,b,c$ and a Plackett-Luce likelihood
function for the six possible orders.  We normalize so $a+b+c=1$ and
take $c=1-a-b$.

## $a\succ b\succ c$

prob = $\frac{ab}{1-a}$

$S=\log a+\log b-\log(1-a)$

$\partial S/\partial a = a^{-1} + (1-a)^{-1}$

$\partial S/\partial b=b^{-1}$

$\partial^2 S/\partial a^2=-a^{-2} +(1-a)^{-2}\longrightarrow -pS_{aa}=\frac{(1-2a)b}{a(1-a)^3}$

$\partial^2 S/\partial b^2 = -b^{-2}\longrightarrow -pS_{bb} = \frac{a}{(1-a)b}$

$\partial^2 S/\partial a\partial b=0\longrightarrow -pS_{ab}= 0$ 

## $a\succ c\succ b$

prob = $\frac{a(1-a-b)}{1-a}$

$S=\log a-\log(1-a) +\log(1-a-b)$

$\partial S/\partial a = a^{-1} + (1-a)^{-1} + (1-a-b)^{-1}$

$\partial S/\partial b = (1-a-b)^{-1}$

$\partial^2S/\partial a^2 = -a^{-2}+(1-a)^{-2} + (1-a-b)^{-2}\longrightarrow -pS_{aa} =\frac{(1-2a)(1-a-b)}{a(1-a)^3} -\frac{a}{1-a}=\frac{(1-2a)(1-a-b) - a^2(1-a)^2}{a(1-a)^3}$

$\partial^2S/\partial b^2=-(1-a-b)^{-2}\longrightarrow -pS_{bb}=\frac{a}{(1-a)(1-a-b)}$

$\partial^2S/\partial a\partial b = (1-a-b)^{-2}\longrightarrow -pS_{ab}=\frac{-a}{(1-a)(1-a-b)}$

## $b\succ a\succ c$

prob = $\frac{ba}{1-b}$

$S=\log a +\log b-\log(1-b)$

$\partial S/\partial a = a^{-1}$

$\partial S/\partial b = b^{-1} +(1-b)^{-1}$

$\partial^2S/\partial a^2 = -a^{-2}\longrightarrow -pS_{aa}=\frac{-b}{a(1-b)}$

$\partial^2S/\partial b^2=-b^{-2} +(1-b)^{-2}\longrightarrow -pS_{bb}=\frac{ab(-1+2b)}{b^2(1-b)^3}$

$\partial^2S/\partial a\partial b=0\longrightarrow -pS_{ab}=0$

## $b\succ c\succ a$

prob = $\frac{a(1-a-b)}{1-b}$

$S=\log a + \log(1-a-b) - \log(1-b)$

$\partial S/\partial a=a^{-1} -(1-a-b)^{-1}$

$\partial S/\partial b=-(1-a-b)^{-1} - (1-b)^{-1}$

$\partial^2S\partial a^2=-a^{-2} -(1-a-b)^{-2}\longrightarrow -pS_{aa}=
\frac{a^4 + 4 a^3 b + 6 a^2 b^2 - 4 a^2 b + 4 a b^3 - 6 a b^2 + 2 a b + b^4 - 2 b^3 + b^2
}{a^2 (a + b - 1)^2 (a + b)^2}$

$\partial^2S/\partial b^2 =-(1-a-b)^{-2} -(1-b)^{-2}$

$\partial^2S/\partial a\partial b=-(1-a-b)^{-2}$

## $c\succ a\succ b$

prob=$\frac{a(1-a-b)}{a+b}$

$S=\log a + \log(1-a-b) -\log(a+b)$

$\partial S/\partial a=a^{-1} -(1-a-b)^{-1} -(a+b)^{-1}$

$\partial S/\partial  b=-(1-a-b)^{-1}-(a+b)^{-1}$

$\partial^2S/\partial a^2=-a^{-2} -(1-a-b)^{-2} +(a+b)^{-2}$

$\partial^2S/\partial b^2=-(1-a-b)^{-2} +(a+b)^{-2}$

$\partial^2S/\partial a\partial b=-(1-a-b)^{-2}+(a+b)^{-2}$

## $c\succ b\succ a$

prob=$\frac{b(1-a-b)}{1-b}$

$S=\log b+\log(1-a-b) -\log(1-b)$

$\partial S/\partial a=-(1-a-b)^{-1}$

$\partial S/\partial b=b^{-1}+(1-b)^{-1} -(1-a-b)^{-1}$

$\partial^2S/\partial a^2=-(1-a-b)^{-2}$

$\partial^2S/\partial b^2=-b^{-2} +(1-b)^{-2}-(1-a-b)^{-2}$

$\partial^2S/\partial a\partial b=-(1-a-b)^{-2}$


## Fisher information matrix

We seek $M$, the two-by-two matrix with entries $\sum_{\sigma\in\left\lbrace
a\succ b\succ c,\ldots, c\succ b\succ a\right\rbrace}\operatorname{Prob}(\sigma)\frac{\partial^2\log\operatorname{Prob}(\sigma)}{\partial x\partial y}$, where $x,y\in\left\lbrace a,b\right\rbrace$.  Then the Fisher information is $\det(M)$.  The whole thing is a bit of a nightmare algebraically but we can use sage to help.

```
var('a b')
p1 = a*b/(1-a)
p2 = a*(1-a-b)/(1-a)
p3 = a*b/(1-b)
p4 = b*(1-a-b)/(1-b)
p5 = a*(1-a-b)/(a+b)
p6 = b*(1-a-b)/(a+b)

pretty_print_default(True)
Faa = (
    -p1*diff(log(p1),a,a).full_simplify()
    -p2*diff(log(p2),a,a).full_simplify()
    -p3*diff(log(p3),a,a).full_simplify()
    -p4*diff(log(p4),a,a).full_simplify()
    -p5*diff(log(p5),a,a).full_simplify()
    -p6*diff(log(p6),a,a).full_simplify()
)

Fab = (
    -p1*diff(log(p1),a,b).full_simplify()
    -p2*diff(log(p2),a,b).full_simplify()
    -p3*diff(log(p3),a,b).full_simplify()
    -p4*diff(log(p4),a,b).full_simplify()
    -p5*diff(log(p5),a,b).full_simplify()
    -p6*diff(log(p6),a,b).full_simplify()
)

Fba = (
    -p1*diff(log(p1),b,a).full_simplify()
    -p2*diff(log(p2),b,a).full_simplify()
    -p3*diff(log(p3),b,a).full_simplify()
    -p4*diff(log(p4),b,a).full_simplify()
    -p5*diff(log(p5),b,a).full_simplify()
    -p6*diff(log(p6),b,a).full_simplify()
)

Fbb = (
    -p1*diff(log(p1),b,b).full_simplify()
    -p2*diff(log(p2),b,b).full_simplify()
    -p3*diff(log(p3),b,b).full_simplify()
    -p4*diff(log(p4),b,b).full_simplify()
    -p5*diff(log(p5),b,b).full_simplify()
    -p6*diff(log(p6),b,b).full_simplify()
)

M = matrix([[Faa,Fab],[Fba,Fbb]])

M.det().subs(a=1/3,b=1/3)
```

gives `1323/16`.


