---
title: "Quantifying the home ground advantage"
author: "Robin K. S. Hankin"
date: "`r Sys.Date()`"
vignette: >
  %\VignetteIndexEntry{home_ground_advantage}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

<p style="text-align: right;">
![](`r system.file("help/figures/hyper2.png", package = "hyper2")`){width=10%}
</p>


(takes about ten minutes to run without cache)

Here I analyse a small synthetic dataset for home ground advantage.

First load the package:
```{r,label=libload}
library(hyper2)
```

Now generate the dataset:

```{r,label=genthedata}
home_games_won <- matrix(c(
    NA, 16, 12, 11,
    19, NA, 19, 16,
    17, 12, NA, 11,
    11, 12, 12, NA),
    nrow=4,ncol=4,byrow=TRUE)

away_games_won <- matrix(c(
    NA, 05, 02, 02,
    02, NA, 10, 02,
    00, 04, NA, 07,
    02, 06, 04, NA),
    nrow=4,ncol=4,byrow=TRUE)

teams <- LETTERS[1:4]
dimnames(home_games_won) <- list("@home" = teams,"@away"=teams)
dimnames(away_games_won) <- list("@home" = teams,"@away"=teams)

home_games_won
away_games_won
```

Thus `home_games_won[1,2] == 16` means A played at home against B and
won 16 times; `home_games_won[2,1] == 19` means B played at home
against A and won 19 times.  Also, `away_games_won[1,2] == 5` means A
played away against B and won 5 times, and `away_games_won[2,1] == 2`
means B played away against A and won 2 times.  Alternatively, A
played B 16+19+5+2=45 times; A played at home 16+2=18 times and won 16
times and lost 2 times; and B played at home 19+5=24 times and won 19
times and lost 5 times.

We will create a hyper2 object with the teams and home ground advantage term:

```{r,label=makehyper2,cache=TRUE}
H <- home_away(home_games_won,away_games_won)
H
options("use_alabama" = TRUE) # to avoid the stupid wmmin bug
specificp.gt.test(H,"home",0)
```

We see strong evidence to support the contention that home advantage is real.
Visually:

```{r,label=showvisH}
dotchart(maxp(H))
```

A profile likelihood diagram:

```{r,label=showprofilelikelihood, cache=TRUE}
home_strength <- seq(from=0.2,to=0.6,length=20)
plot(home_strength,profsupp(H,"home",home_strength),type="b",pch=16,
     xlab="home strength",ylab="support",main="profile likelihood for home advantage")
abline(h=c(0,-2))
```

The figure give a support interval between about 0.3 and 0.5 for home
ground advantage.
